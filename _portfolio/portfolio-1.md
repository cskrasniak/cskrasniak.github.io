---
title: "Logistic regression for mind reading"
excerpt: "Feature engineering to find the best regressors for predicting a visual stimulus from mouse neural activity <br/><img src='/images/model_comparison_weights_frame_3.png'>"
collection: portfolio
---

Here I was trying to see what linear combination of activity led to the best prediction of what stimulus the mouse was seeing from its neural activity. I additionally wanted to use the weights from the logistic regression to determine how information was being used from different areas of the brain to best predict the stimulus. In (a) I plot the accuracy of five different logistic regression models through time relative to the onset of the stimulus. Here you can see that immediately following the onset (frames 0-3) the best models are the difference model, where I take the time derivative of the activity as an input, and the two-frame model, where I input two consecutive imaging frames, allowing the model to find the best linear combination of activity through time. In fact these perform quite well given that the black dotted line is the accuracy of the mouse performance, showing that we can predict the stimulus almost as well as the mouse can.
In the subsequent subpanels I show the weights of each model projected onto a map of the cortex of the mouse. The single frame and sum models that perform relatively poorly, do not have any clear pattern in their weights. However, the difference model in panel (g) shows a clear pattern with strong weights in the primary visual cortex (triangular area near the bottom) and the secondary motor cortex (large area near the front). These weights are also in the expected direction, with the left hemisphere having weights predictive of right stimuli and vice versa. Interestingly, the weights on the two frames of the two-frame model (d and e) seem to have opposite signed weights in these same areas across the two frames. However, if you take the difference of the weights on these two frames (f), you see the two-frame model is essentially learning to take the time derivative like the difference model, showing that the best linear combination of activity through time near the onset of the stimulus is the time difference.
